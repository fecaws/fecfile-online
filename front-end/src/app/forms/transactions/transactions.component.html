<div class="transactions__main-container">
  <!-- div class="form__sidebar">
    <div class="transactions__sidebar_filters">
      <app-transactions-filter [hidden]="!isShowFilters" title="Filters" [formType]="formType">
      </app-transactioYesns-filter>
    </div>
  </div-->
  <div class="transactions__container">
    <header>
      <div class="header-content">
        <div class="grid-row">
          <div class="grid-row__col grid-row__col--12">
            <div class="float-left">
              <h1 *ngIf="!isEditViewActive(); else editHeading">
                Transactions / Form {{ formType }}
                <span [@fadeInOut] *ngIf="isRecycleBinViewActive()">
                  / Recycling Bin
                  <span class="trash-icon"></span>
                </span>
              </h1>
              <ng-template #editHeading>
                <h1 [@fadeInOut] *ngIf="isEditViewActive()">Form {{ formType }} / {{ transactionToEdit.type }} / Edit</h1>
              </ng-template>
            </div>
            <div class="float-right">
              <button
                [@fadeInOut]
                *ngIf="isShowFilters"
                class="btn btn-primary btn-right"
                type="submit"
                (click)="showCategories()"
              >
                Return to Transaction Categories
              </button>
            </div>
         </div>
       </div>
        <div class="grid-row">
            <div class="grid-row__col grid-row__col--12">
          <div class="float-right"   ngbDropdown role="group" aria-label="Action dropdown">
            <button
              type="button"
              class="btn btn-link btn-options"
              id="actionsMenu"
              ngbDropdownToggle
            >
              <span class="ellipsis-icon" aria-hidden="true"></span>
              <span class="sr-only">Click for more options</span>
            </button>
            <div ngbDropdownMenu aria-labelledby="actionsMenu">
              <button class="dropdown-item"><i class="view-icon"></i> View</button>
              <button class="dropdown-item" (click)="printPreview()" ><i class="print-icon"></i> Print</button>
              <button class="dropdown-item"><i class="far fa-file-import"></i> Import</button>            
            </div>
            </div>
          </div>
        </div>
      
      </div>
      <hr />
    </header>
    <div>
      <div *ngIf="!isEditViewActive()">
        <div class="grid-row">
          <div class="grid-row__col grid-row__col--12">
            <div class="transactions__btn-container">
              <button
                [@fadeInOut]
                *ngIf="isTransactionViewActive()"
                class="btn btn-primary btn-left transactions__trx-btn"
                type="button"
                (click)="showPinColumns()"
              >
                <i class="thumbtack-icon"></i>
                Pin Columns
              </button>
              <button
                [@fadeInOut]
                *ngIf="isTransactionViewActive()"
                class="btn btn-primary btn-left transactions__trx-btn"
                type="button"
                (click)="showRecycleBin()"
              >
                <i class="trash-icon"></i>
                Recycle Bin
              </button>
              <button
                [@fadeInOut]
                *ngIf="isTransactionViewActive()"
                class="btn btn-primary btn-left transactions__trx-btn"
                type="button"
                (click)="showFilters()"
              >
                <i class="filter-icon"></i>
                Filter
              </button>
              <button
                [@fadeInOut]
                *ngIf="isRecycleBinViewActive()"
                class="btn btn-primary btn-left transactions__trx-btn"
                type="button"
                (click)="showTransactions()"
              >
                <i class="table-icon"></i>
                Transactions
              </button>
              <button
                [@fadeInOut]
                *ngIf="isRecycleBinViewActive()"
                class="btn btn-primary btn-left transactions__trx-btn"
                type="button"
                (click)="showFilters()"
              >
                <i class="filter-icon"></i>
                Filter
              </button>
              <div class="input-group pl-0 transactions__trx-search">
                <div
                  class="input-group-append"
                  (click)="clearSearchAndFilters()"
                  ngbTooltip="Clear Keywords and Filters"
                  tooltipClass="form-tooltip"
                >
                  <span class="input-group-text" id="">
                    <i class="fas fa-eraser text-grey" aria-hidden="true"></i>
                  </span>
                </div>
                <input
                  class="form-control py-1"
                  type="text"
                  placeholder="Search All"
                  [(ngModel)]="searchText"
                  aria-label="Search"
                />
                <div class="input-group-append" (click)="search()" ngbTooltip="Search All" tooltipClass="form-tooltip">
                  <span class="input-group-text" id="">
                    <!-- <i class="search-icon text-grey" aria-hidden="true"></i> no longer working?-->
                    <i class="fas fa-search text-grey" aria-hidden="true"></i>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="grid-row">
          <div class="grid-row__col grid-row__col--12">
            <div class="transactions__btn-container">
              <div class="transactions__tag-outer-wrapper">
                <div id="button-container" class="transactions__tag_wrapper">
                  <div *ngFor="let tag of tagArray">
                    <div *ngIf="tag.group.length > 0" class="transactions__tag_group">
                      <span *ngFor="let gTag of tag.group; let i = index">
                        <button
                          class="btn transactions__tag_btn transactions__btn-search-filter"
                          (click)="removeTag(tag.type, i, gTag)"
                        >
                          <i class="fas fa-window-close transactions__close-tag"></i>
                          <span *ngIf="tag.type !== 'amount' && tag.type !== 'aggregateAmount' && tag.type !== 'date'">
                            <span *ngIf="tag.prefix">{{ tag.prefix }}: </span>{{ gTag }}
                          </span>
                          <span *ngIf="tag.type === 'date'"
                            >{{ tag.prefix }}: {{ gTag.filterDateFrom | date: 'MM/dd/yyyy' }} -
                            {{ gTag.filterDateTo | date: 'MM/dd/yyyy' }}
                          </span>
                          <span *ngIf="tag.type === 'amount'"
                            >{{ tag.prefix }}: {{ gTag.filterAmountMin | currency: 'USD':'symbol-narrow':'1.2-2' }} -
                            {{ gTag.filterAmountMax | currency: 'USD':'symbol-narrow':'1.2-2' }}
                          </span>
                          <span *ngIf="tag.type === 'aggregateAmount'"
                            >{{ tag.prefix }}:
                            {{ gTag.filterAggregateAmountMin | currency: 'USD':'symbol-narrow':'1.2-2' }} -
                            {{ gTag.filterAggregateAmountMax | currency: 'USD':'symbol-narrow':'1.2-2' }}
                          </span>
                        </button>
                        <span class="transactions__btn-search-filter-join" *ngIf="i < tag.group.length - 1">
                          or
                        </span>
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- <br>
              <hr>
              <br> -->

              <!-- <div style="display: inline-block">
                <div id="button-container" class="transactions__tag_wrapper">
                  <div *ngIf="searchTextArray.length > 0" class="transactions__tag_group">
                    <span *ngFor="let searchTextItem of searchTextArray; let i = index">
                      <button 
                        class="btn transactions__tag_btn transactions__btn-search-filter"
                        (click)="removeSearchText(i)">
                        <i class="fas fa-window-close"></i>
                        {{ searchTextItem }}
                      </button>
                      <span class="transactions__btn-search-filter-join" 
                        *ngIf="i < (searchTextArray.length -1 )">
                          or
                      </span>
                    </span>
                  </div>
                  <div *ngIf="filters.filterCategories && filters.filterCategories.length > 0" 
                      class="transactions__tag_group">
                    <span *ngFor="let categoryZ of filters.filterCategories; let i = index">
                      <button
                        class="btn transactions__tag_btn transactions__btn-search-filter"
                        (click)="removeCategoryFilter(i, categoryZ)">
                        <i class="fas fa-window-close"></i>
                        Type: {{ categoryZ }}
                      </button>
                      <span class="transactions__btn-search-filter-join" 
                        *ngIf="i < (filters.filterCategories.length -1 )">
                          or
                      </span>
                    </span>
                  </div> 
                  <div *ngIf="filters.filterDateFrom  && filters.filterDateTo"
                      class="transactions__tag_group">
                    <button
                      class="btn transactions__tag_btn transactions__btn-search-filter"
                      (click)="removeDateFilter()">
                      <i class="fas fa-window-close"></i>
                      Date: {{ filters.filterDateFrom | date: 'MM/dd/yyyy'}} - 
                              {{ filters.filterDateTo | date: 'MM/dd/yyyy'}}
                    </button>
                  </div>
                  <div *ngIf="filters.filterStates && filters.filterStates.length > 0" 
                      class="transactions__tag_group">
                    <span *ngFor="let state of filters.filterStates; let i = index">
                      <button
                        class="btn transactions__tag_btn transactions__btn-search-filter"
                        (click)="removeStateFilter(i, state)">
                        <i class="fas fa-window-close"></i>
                        {{ state }}
                      </button>
                      <span class="transactions__btn-search-filter-join" 
                        *ngIf="i < (filters.filterStates.length -1 )">
                          or
                      </span>
                    </span>                   
                  </div>
                  <div *ngIf="filters.filterAmountMin > 0 && filters.filterAmountMax > 0"
                      class="transactions__tag_group">
                    <button
                      class="btn transactions__tag_btn transactions__btn-search-filter"
                      (click)="removeAmountFilter()">
                      <i class="fas fa-window-close"></i>
                      Amount: {{ filters.filterAmountMin | currency:'USD':'symbol-narrow':'1.2-2'}} - 
                              {{ filters.filterAmountMax | currency:'USD':'symbol-narrow':'1.2-2'}}
                    </button>
                  </div>                    
                </div> -->

              <!-- <div id="" class="transactions__tag_wrapper">
                  <span *ngFor="let categoryZ of filters.filterCategories; let i = index">
                    <button
                      class="btn transactions__tag_btn transactions__btn-search-filter"
                      (click)="removeCategoryFilter(i, categoryZ)">
                      <i class="fas fa-window-close"></i>
                      Type: {{ categoryZ }}
                    </button>
                    <span class="transactions__btn-search-filter-join" 
                      *ngIf="i < (filters.filterCategories.length -1 )">
                        or
                    </span>
                  </span>
                </div>
              </div> -->

              <!-- <div *ngFor="let searchTextItem of searchTextArray; let i = index">
                <div class="tag__category">
                  <button
                    class="btn btn-left transactions__btn-search-filter transactions__btn-container;"
                    (click)="removeSearchText(i)">
                    <i class="fas fa-window-close"></i>
                    {{ searchTextItem }}
                  </button>
                  <span class="transactions__btn-search-filter-join" 
                    *ngIf="i < (searchTextArray.length -1 )">
                      or
                  </span>
                </div>
              </div> -->

              <!-- <div *ngFor="let categoryZ of filters.filterCategories; let i = index">
                <button
                  class="btn btn-left transactions__btn-search-filter transactions__btn-container;"
                  (click)="removeCategoryFilter(i, categoryZ)">
                  <i class="fas fa-window-close"></i>
                  Type: {{ categoryZ }}
                </button>
                <span class="transactions__btn-search-filter-join" 
                  *ngIf="i < (filters.filterCategories.length -1 )">
                    or
                </span>
              </div> -->

              <!-- <div *ngIf="filters.filterDateFrom  && filters.filterDateTo">
                <button
                  class="btn btn-left transactions__btn-search-filter transactions__btn-container;"
                  (click)="removeDateFilter()">
                  <i class="fas fa-window-close"></i>
                  Date: {{ filters.filterDateFrom | date: 'MM/dd/yyyy'}} - 
                          {{ filters.filterDateTo | date: 'MM/dd/yyyy'}}
                </button>
              </div>  -->
              <!-- <div *ngFor="let state of filters.filterStates; let i = index">
                <button
                  class="btn btn-left transactions__btn-search-filter transactions__btn-container;"
                  (click)="removeStateFilter(i, state)">
                  <i class="fas fa-window-close"></i>
                  {{ state }}
                </button>
                <span class="transactions__btn-search-filter-join" 
                  *ngIf="i < (filters.filterStates.length -1 )">
                    or
                </span>
              </div>  -->
              <!-- <div *ngIf="filters.filterAmountMin > 0 && filters.filterAmountMax > 0">
                <button
                  class="btn btn-left transactions__btn-search-filter transactions__btn-container;"
                  (click)="removeAmountFilter()">
                  <i class="fas fa-window-close"></i>
                  Amount: {{ filters.filterAmountMin | currency:'USD':'symbol-narrow':'1.2-2'}} - 
                          {{ filters.filterAmountMax | currency:'USD':'symbol-narrow':'1.2-2'}}
                </button>
              </div>  -->
            </div>
          </div>
        </div>
      </div>
      <app-transactions-table
        *ngIf="isTransactionViewActive()"
        formType="{{ formType }}"
        [reportId]="reportId"
        tableType="{{ transactionsView }}"
      >
      </app-transactions-table>
      <app-transactions-table
        *ngIf="isRecycleBinViewActive()"
        formType="{{ formType }}"
        [reportId]="reportId"
        tableType="{{ recycleBinView }}"
      >
      </app-transactions-table>
      <app-transactions-edit
        *ngIf="isEditViewActive()"
        [transactionToEdit]="transactionToEdit"
        formType="{{ formType }}"
        [reportId]="reportId"
      >
      </app-transactions-edit>
    </div>
  </div>

  <div>
    <button class="btn btn-previous btn-left" type="button" (click)="goToPreviousStep()">
      Previous
    </button>
  </div>
</div>
