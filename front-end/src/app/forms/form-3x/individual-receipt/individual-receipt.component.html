<div class="individual-receipt-container">
  <form [formGroup]="frmIndividualReceipt" (ngSubmit)="doValidateReceipt()">
    <header>
      <div class="header-content">
        <div class="float-left">
          <h1>
            Form 3X
            <ng-container *ngIf="transactionTypeText"> / {{ transactionTypeText }} </ng-container>
          </h1>
        </div>
        <div class="float-right" ngbDropdown>
          <button type="button" class="btn btn-link btn-options" id="dropdownBasic2" ngbDropdownToggle>
            <span class="ellipsis-icon" aria-hidden="true"></span>
            <span class="sr-only">Click for more options</span>
          </button>
          <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
            <button class="dropdown-item"><i class="view-icon"></i> View</button>
            <button class="dropdown-item"><i class="print-icon"></i> Print</button>
          </div>
        </div>
      </div>
      <hr />
    </header>
    <section>
      <ng-container *ngFor="let hiddenField of hiddenFields">
        <input type="hidden" [name]="hiddenField.name" [value]="hiddenField.value" />
      </ng-container>
      <ng-container *ngFor="let row of formFields">
        <div class="row" *ngIf="row.cols">
          <ng-container *ngIf="row.cols | isArray">
            <div class="col" *ngFor="let col of row.cols">
              <div class="form-group">
                <label for="{{ col.name }}">
                  {{ col.text }}
                  <button
                    type="button"
                    class="btn btn-info"
                    ngbTooltip="{{ col.infoText }}"
                    tooltipClass="form-tooltip"
                    *ngIf="col.infoIcon"
                  >
                    <i class="info-icon" aria-hidden="true"></i>
                    <span class="sr-only">Click here for more information</span>
                  </button>
                </label>
                <ng-container *ngIf="col.type === 'text' || col.type === 'date' || col.type === 'number'">
                  <ng-container *ngIf="col.inputGroup">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text">
                          <i [class]="col.inputIcon" aria-hidden="true"></i>
                        </span>
                      </div>
                      <input
                        class="form-control"
                        [type]="col.type"
                        [name]="col.name"
                        [formControlName]="col.name"
                        [ngClass]="
                          frmIndividualReceipt.get(col.name).invalid &&
                          (frmIndividualReceipt.touched || frmIndividualReceipt.dirty)
                            ? 'input-field-error'
                            : ''
                        "
                      />
                    </div>
                  </ng-container>
                  <ng-container *ngIf="!col.inputGroup">
                    <input
                      class="form-control"
                      [type]="col.type"
                      [name]="col.name"
                      [formControlName]="col.name"
                      [ngClass]="
                        frmIndividualReceipt.get(col.name).invalid &&
                        (frmIndividualReceipt.touched || frmIndividualReceipt.dirty)
                          ? 'input-field-error'
                          : ''
                      "
                    />
                  </ng-container>
                  <div
                    class="error-text"
                    *ngIf="
                      (frmIndividualReceipt.touched || frmIndividualReceipt.dirty) &&
                      frmIndividualReceipt.get(col.name).invalid
                    "
                  >
                    <div class="text-error text-left" *ngIf="frmIndividualReceipt.get(col.name).errors?.required">
                      {{ col.text }} is required.
                    </div>
                    <ng-container *ngIf="frmIndividualReceipt.get(col.name).errors?.maxlength">
                      <div
                        class="text-error text-left"
                        *ngIf="
                          frmIndividualReceipt.get(col.name).errors.maxlength?.requiredLength <
                          frmIndividualReceipt.get(col.name).errors.maxlength?.actualLength
                        "
                      >
                        Only {{ frmIndividualReceipt.get(col.name).errors.maxlength?.requiredLength }} characters
                        allowed.
                      </div>
                    </ng-container>
                    <ng-container *ngIf="frmIndividualReceipt.get(col.name).errors">
                      <div
                        class="text-error text-left"
                        *ngIf="frmIndividualReceipt.get(col.name).errors?.nonAlphaNumeric"
                      >
                        Alphanumeric characters only.
                      </div>
                    </ng-container>
                    <ng-container *ngIf="frmIndividualReceipt.get(col.name).errors">
                      <div
                        class="text-error text-left"
                        *ngIf="frmIndividualReceipt.get(col.name).errors?.nonFloatingPoint"
                      >
                        Floating point numbers only.
                      </div>
                    </ng-container>
                  </div>
                </ng-container>
                <ng-container *ngIf="col.type === 'textarea'">
                  <textarea class="form-control" rows="5" name="{{ col.name }}" [formControlName]="col.name"></textarea>
                </ng-container>
                <ng-container *ngIf="col.type === 'select' && col.name === 'ContributorState'">
                  <ng-select
                    class="state-select"
                    [formControlName]="col.name"
                    [ngClass]="
                      frmIndividualReceipt.get(col.name).invalid &&
                      (frmIndividualReceipt.touched || frmIndividualReceipt.dirty)
                        ? 'input-field-error'
                        : ''
                    "
                  >
                    <ng-option *ngFor="let item of states" [value]="item.code">
                      {{ item.name }}
                    </ng-option>
                  </ng-select>

                  <div
                    class="error-text"
                    *ngIf="
                      (frmIndividualReceipt.touched || frmIndividualReceipt.dirty) &&
                      frmIndividualReceipt.get(col.name).invalid
                    "
                  >
                    <div class="text-error text-left" *ngIf="frmIndividualReceipt.get(col.name).errors?.required">
                      {{ col.text }} is required.
                    </div>
                  </div>
                </ng-container>
              </div>
            </div>
          </ng-container>
        </div>
      </ng-container>
    </section>
    <footer>
      <footer>
        <div class="grid-row">
          <div class="grid-row__col grid-row__col--12">
            <div class="forms__btn-container">
              <button class="btn btn-previous btn-left" type="button" (click)="previousStep()">
                Previous
              </button>
              <button class="btn btn-secondary btn-right" type="submit">
                Save &amp; Add Transaction
              </button>
              <a class="btn btn-previous btn-right" [routerLink]="['/forms/transactions', '3X']">
                View Transactions
              </a>
            </div>
          </div>
        </div>
      </footer>
    </footer>
  </form>
</div>
