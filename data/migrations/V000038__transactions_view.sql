create or replace view all_transactions_view as 
SELECT sa.cmte_id, 
       sa.report_id, 
       sa.line_number, 
       sa.transaction_type, 
       rt.transaction_type_desc, 
       rt.transaction_type_mini_desc,
       sa.transaction_id, 
       sa.back_ref_transaction_id, 
       sa.back_ref_sched_name, 
       sa.entity_id, 
       (case when e.entity_type in ('IND','CAN') THEN last_name||','||first_name else e.entity_name end) as name,
       e.street_1,
       e.street_2,
       e.city,
       e.state,
       e.zip_code,
       e.occupation,
       e.employer,       
       sa.contribution_date as transaction_date, 
       sa.contribution_amount as transaction_amount, 
       sa.purpose_description, 
       sa.memo_code, 
       sa.memo_text, 
       sa.election_code, 
       sa.election_other_description, 
       sa.delete_ind, 
       sa.create_date, 
       sa.last_update_date
	FROM (public.sched_a sa join entity e on e.entity_id=sa.entity_id)
       left outer join ref_transaction_type rt on rt.transaction_type=sa.transaction_type;
